"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j={exports:{}},B={exports:{}},E;function J(){return E||(E=1,function(e){(function(p){var n={bytesToHex:function(i){return o(i)},hexToBytes:function(i){if(i.length%2===1)throw new Error("hexToBytes can't have a string with an odd number of characters.");return i.indexOf("0x")===0&&(i=i.slice(2)),i.match(/../g).map(function(f){return parseInt(f,16)})}};function o(i){return i.map(function(f){return c(f.toString(16),2)}).join("")}function c(i,f){return i.length>f?i:Array(f-i.length+1).join("0")+i}e.exports?e.exports=n:p.convertHex=n})(w)}(B)),B.exports}var C={exports:{}},A;function W(){return A||(A=1,function(e){(function(p){var n={bytesToString:function(o){return o.map(function(c){return String.fromCharCode(c)}).join("")},stringToBytes:function(o){return o.split("").map(function(c){return c.charCodeAt(0)})}};n.UTF8={bytesToString:function(o){return decodeURIComponent(escape(n.bytesToString(o)))},stringToBytes:function(o){return n.stringToBytes(unescape(encodeURIComponent(o)))}},e.exports?e.exports=n:p.convertString=n})(w)}(C)),C.exports}(function(e){(function(p){var n={};e.exports?(n.bytesToHex=J().bytesToHex,n.convertString=W(),e.exports=g):(n.bytesToHex=p.convertHex.bytesToHex,n.convertString=p.convertString,p.sha256=g);var o=[];(function(){function r(a){for(var l=Math.sqrt(a),d=2;d<=l;d++)if(!(a%d))return!1;return!0}function u(a){return(a-(a|0))*4294967296|0}for(var s=2,t=0;t<64;)r(s)&&(o[t]=u(Math.pow(s,1/3)),t++),s++})();var c=function(r){for(var u=[],s=0,t=0;s<r.length;s++,t+=8)u[t>>>5]|=r[s]<<24-t%32;return u},i=function(r){for(var u=[],s=0;s<r.length*32;s+=8)u.push(r[s>>>5]>>>24-s%32&255);return u},f=[],O=function(r,u,s){for(var t=r[0],a=r[1],l=r[2],d=r[3],y=r[4],T=r[5],S=r[6],b=r[7],v=0;v<64;v++){if(v<16)f[v]=u[s+v]|0;else{var h=f[v-15],P=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,x=f[v-2],$=(x<<15|x>>>17)^(x<<13|x>>>19)^x>>>10;f[v]=P+f[v-7]+$+f[v-16]}var M=y&T^~y&S,R=t&a^t&l^a&l,U=(t<<30|t>>>2)^(t<<19|t>>>13)^(t<<10|t>>>22),D=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),_=b+D+M+o[v]+f[v],I=U+R;b=S,S=T,T=y,y=d+_|0,d=l,l=a,a=t,t=_+I|0}r[0]=r[0]+t|0,r[1]=r[1]+a|0,r[2]=r[2]+l|0,r[3]=r[3]+d|0,r[4]=r[4]+y|0,r[5]=r[5]+T|0,r[6]=r[6]+S|0,r[7]=r[7]+b|0};function g(r,u){r.constructor===String&&(r=n.convertString.UTF8.stringToBytes(r));var s=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t=c(r),a=r.length*8;t[a>>5]|=128<<24-a%32,t[(a+64>>9<<4)+15]=a;for(var l=0;l<t.length;l+=16)O(s,t,l);var d=i(s);return u&&u.asBytes?d:u&&u.asString?n.convertString.bytesToString(d):n.bytesToHex(d)}g.x2=function(r,u){return g(g(r,{asBytes:!0}),u)}})(w)})(j);var G=j.exports;const F=N(G);function k(e){return Buffer.from(e).toString("base64")}function q(e){return Buffer.from(e,"base64")}function K(e,p){let n=k(JSON.stringify(e)),o=F(`${n}.${p}`);return n+"."+o}function L(e,p){return new Promise((n,o)=>{let c=e.split(".");c.length==2&&(F(`${c[0]}.${p}`)==c[1]?n(JSON.parse(q(c[0]))):o({status:501,description:"invalid signature"})),o({status:502,description:"invalid token"})})}exports.base64_decode=q;exports.base64_encode=k;exports.create_token=K;exports.sha256=F;exports.verify_token=L;
//# sourceMappingURL=index.cjs.min.js.map
