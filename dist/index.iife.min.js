var sha256=function(g){"use strict";var B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function P(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var E={exports:{}},C={exports:{}},A;function $(){return A||(A=1,function(e){(function(l){var n={bytesToHex:function(i){return o(i)},hexToBytes:function(i){if(i.length%2===1)throw new Error("hexToBytes can't have a string with an odd number of characters.");return i.indexOf("0x")===0&&(i=i.slice(2)),i.match(/../g).map(function(f){return parseInt(f,16)})}};function o(i){return i.map(function(f){return c(f.toString(16),2)}).join("")}function c(i,f){return i.length>f?i:Array(f-i.length+1).join("0")+i}e.exports?e.exports=n:l.convertHex=n})(B)}(C)),C.exports}var w={exports:{}},j;function M(){return j||(j=1,function(e){(function(l){var n={bytesToString:function(o){return o.map(function(c){return String.fromCharCode(c)}).join("")},stringToBytes:function(o){return o.split("").map(function(c){return c.charCodeAt(0)})}};n.UTF8={bytesToString:function(o){return decodeURIComponent(escape(n.bytesToString(o)))},stringToBytes:function(o){return n.stringToBytes(unescape(encodeURIComponent(o)))}},e.exports?e.exports=n:l.convertString=n})(B)}(w)),w.exports}(function(e){(function(l){var n={};e.exports?(n.bytesToHex=$().bytesToHex,n.convertString=M(),e.exports=h):(n.bytesToHex=l.convertHex.bytesToHex,n.convertString=l.convertString,l.sha256=h);var o=[];(function(){function r(a){for(var d=Math.sqrt(a),p=2;p<=d;p++)if(!(a%p))return!1;return!0}function u(a){return(a-(a|0))*4294967296|0}for(var s=2,t=0;t<64;)r(s)&&(o[t]=u(Math.pow(s,.3333333333333333)),t++),s++})();var c=function(r){for(var u=[],s=0,t=0;s<r.length;s++,t+=8)u[t>>>5]|=r[s]<<24-t%32;return u},i=function(r){for(var u=[],s=0;s<r.length*32;s+=8)u.push(r[s>>>5]>>>24-s%32&255);return u},f=[],I=function(r,u,s){for(var t=r[0],a=r[1],d=r[2],p=r[3],y=r[4],S=r[5],b=r[6],_=r[7],v=0;v<64;v++){if(v<16)f[v]=u[s+v]|0;else{var T=f[v-15],N=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,x=f[v-2],J=(x<<15|x>>>17)^(x<<13|x>>>19)^x>>>10;f[v]=N+f[v-7]+J+f[v-16]}var W=y&S^~y&b,G=t&a^t&d^a&d,K=(t<<30|t>>>2)^(t<<19|t>>>13)^(t<<10|t>>>22),L=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),O=_+L+W+o[v]+f[v],z=K+G;_=b,b=S,S=y,y=p+O|0,p=d,d=a,a=t,t=O+z|0}r[0]=r[0]+t|0,r[1]=r[1]+a|0,r[2]=r[2]+d|0,r[3]=r[3]+p|0,r[4]=r[4]+y|0,r[5]=r[5]+S|0,r[6]=r[6]+b|0,r[7]=r[7]+_|0};function h(r,u){r.constructor===String&&(r=n.convertString.UTF8.stringToBytes(r));var s=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t=c(r),a=r.length*8;t[a>>5]|=128<<24-a%32,t[(a+64>>9<<4)+15]=a;for(var d=0;d<t.length;d+=16)I(s,t,d);var p=i(s);return u&&u.asBytes?p:u&&u.asString?n.convertString.bytesToString(p):n.bytesToHex(p)}h.x2=function(r,u){return h(h(r,{asBytes:!0}),u)}})(B)})(E);var R=E.exports;const F=P(R);function k(e){return Buffer.from(e).toString("base64")}function q(e){return Buffer.from(e,"base64")}function U(e,l){let n=k(JSON.stringify(e)),o=F(`${n}.${l}`);return n+"."+o}function D(e,l){return new Promise((n,o)=>{let c=e.split(".");c.length==2&&(F(`${c[0]}.${l}`)==c[1]?n(JSON.parse(q(c[0]))):o({status:501,description:"invalid signature"})),o({status:502,description:"invalid token"})})}return g.base64_decode=q,g.base64_encode=k,g.create_token=U,g.sha256=F,g.verify_token=D,Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),g}({});
//# sourceMappingURL=index.iife.min.js.map
